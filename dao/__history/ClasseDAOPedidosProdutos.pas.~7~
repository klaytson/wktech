unit ClasseDAOPedidosProdutos;

interface

Uses ClassePedidosProdutos, UDMPrincipal, System.SysUtils;

Type
  TDAOPedidosProdutos = class

    public
      procedure Inserir(PedidosProdutos: TPedidosProdutos);
      procedure Salvar(PedidosProdutos: TPedidosProdutos);
      Function ObterNumeroPedido(): Integer;
  end;

implementation

{ DAOClientes }

procedure TDAOPedidosProdutos.Inserir(pedidosProdutos: TPedidosProdutos);
Var
  PedidosProdutos: TPedidosProdutos;
  codigopedido: integer;
begin
  PedidosProdutos := TPedidosProdutos.Create();
  PedidosProdutos := pedidosProdutos;

  With DmPrincipal.QryAux Do
    begin
      Close;
      SQL.Clear;
      SQL.Add('INSERT INTO `wktech`.`pedidos_dados_gerais` (`DataEmissao`, `CodigoCliente`, `ValorTotal`) VALUES (:DTEMISSAO, :COD, :TOTAL)');

      ParamByName('DTEMISSAO').Value := FormatDateTime('yyyy-mm-dd', objPedido.DataEmissao);
      ParamByName('COD').AsInteger := objPedido.CodigoCliente;
      ParamByName('TOTAL').Value := objPedido.ValorTotal;
      ExecSQL;
    end;
end;

function TDAOPedidosProdutos.ObterNumeroPedido: Integer;
begin
  With DmPrincipal.QryAux Do
    begin
      Close;
      SQL.Clear;
      SQL.Add('SELECT NUMEROPEDIDO FROM wktech.pedidos_dados_gerais ORDER BY NUMEROPEDIDO DESC LIMIT 1');
      Open;

      Result := FieldByName('NUMEROPEDIDO').AsInteger;
    end;
end;

procedure TDAOPedidosProdutos.Salvar(pedidos: TPedidos);
begin

end;

end.
